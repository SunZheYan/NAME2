<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>name</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css' rel='stylesheet' type='text/css'>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="js/web3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.6.0/web3.min.js"></script>
</head>

<body class="container">
    <h1>輸入名字</h1>
    <script>
        window.addEventListener('load', async() => {
            if (window.ethereum) {
                web3js = new Web3(window.ethereum);
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });
                startApp();
                FB.init();
            } else if (window.web3) {
                web3js = new Web3(web3.currentProvider);
                startApp();
                FB.init();
            } else {
                alert("請先安裝MetaMask");
            }
        });

        /*
                $(".btn.login").click(async() => { //連結metamask
                    try {

                        web3js = new Web3(window.ethereum); //建立web3連結
                        const accounts = await window.ethereum.request({
                            method: 'eth_requestAccounts'
                        });
                        user = accounts[0];
                        $("#username").html(user);

                        startApp();
                        userAccount = web3js.currentProvider.selectedAddress; //不明用途，取自CrappyBird 893行

                    } catch (error) {
                        alert(error.message);
                    }
                })
        */
        /*
                $(document).ready(function() {
                    $(".ByAccount").click(function() {
                        $(".test").hide();
                    });
                });
                */

        function startApp() {
            var name1 = '0x02d8949693f141335ee4266bfa6dab0216690491';
            search = new web3js.eth.Contract(NAME, name1);
            userAccount = web3.currentProvider.selectedAddress;

        }









        /*
                $(document).ready(function() {
                    $(".hid").click(function() {

                        $(".test").hide();
                    });
                    
                                            alert(userAccount);
                                            $("#RP").html(userAccount);
                                            
                });
                */
        /*
                   $(".show").click(function() {
                        web3js = new Web3(window.ethereum);
                        const accounts = await window.ethereum.request({
                            method: 'eth_requestAccounts'
                        });
                        startApp();
                    });
                });
                */
        $(document).ready(function() {
            $(".ByAccount").click(function() {

                userAccount = web3.currentProvider.selectedAddress;
                var balance = web3.eth.getBalance(0xbF3868FF1393aAD3816Cd461C5891EB75A5cC213);
                alert(balance);

            });
        });
        $(document).ready(function() {
            $(".show").click(async function() {
                userAccount = web3.currentProvider.selectedAddress;
                var savedscore = await search.methods.whatIsMyNamepublic().call({
                    from: userAccount
                });
                alert(savedscore);
            });
        });
        $(document).ready(function() {
            $(".hid").click(async function() {
                userAccount = web3.currentProvider.selectedAddress;
                addresname = document.getElementById("readbyAccount").value;
                var savedscore = await search.methods.namein(addresname).send({
                    from: userAccount
                });
            });
        });
    </script>
    <div class="table-responsive">

        <input name="val" type="text" id="readbyAccount" onchange="myFunction()" />
        <button onclick="myFunction(candidate)">連線</button>
        <button class="ByAccount">連</button>
        <input type="button" onclick="myfunction()" value="Display alert box" />
        <div id="msg"></div>
        <p class="test">这是一个段落。</p>
        <p>这是另外一</p>
        <button class="hid">傳輸</button>
        <button class="show">查詢</button>
        <div>
            <span id="RP">show RP</span>
        </div>


        <script src="https://cdn.rawgit.com/ethereum/web3.js/develop/dist/web3.js"></script>

        <script src="name2_abi.js"></script>
</body>

</html>